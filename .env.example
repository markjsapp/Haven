# Haven Backend Configuration
# Copy this to .env and adjust as needed.
# Defaults are set for local development with docker-compose.

# Server
HAVEN_HOST=0.0.0.0
HAVEN_PORT=8080

# PostgreSQL (matches docker-compose.yml)
DATABASE_URL=postgres://haven:haven_secret@localhost:5432/haven

# Redis
REDIS_URL=redis://127.0.0.1:6379

# JWT — CHANGE THIS IN PRODUCTION
JWT_SECRET=change-me-to-a-random-64-char-hex-string
JWT_EXPIRY_HOURS=24
REFRESH_TOKEN_EXPIRY_DAYS=30

# Local Storage (attachments stored on disk, encrypted at rest with AES-256-GCM)
# Generate a key with: openssl rand -hex 32
STORAGE_DIR=./data/attachments
STORAGE_ENCRYPTION_KEY=<generate-with-openssl-rand-hex-32>

# S3 (uncomment when deploying to production)
# S3_ENDPOINT=http://localhost:9000
# S3_BUCKET=haven-attachments
# S3_ACCESS_KEY=minioadmin
# S3_SECRET_KEY=minioadmin
# S3_REGION=us-east-1

# CORS — comma-separated allowed origins (* = allow all, for dev only)
# In production, set this to your frontend URL(s)
CORS_ORIGINS=http://localhost:5173

# Rate Limiting (per IP)
MAX_REQUESTS_PER_MINUTE=120
MAX_WS_CONNECTIONS_PER_USER=5

# File Upload
MAX_UPLOAD_SIZE_BYTES=524288000

# LiveKit (self-hosted, matches docker-compose.yml)
# For local dev: ws://localhost:7880
# For production with TLS: wss://livekit.yourdomain.com
# Generate credentials with: openssl rand -hex 12 (key) and openssl rand -base64 32 (secret)
LIVEKIT_URL=ws://localhost:7880
LIVEKIT_API_KEY=<generate-with-openssl-rand-hex-12>
LIVEKIT_API_SECRET=<generate-with-openssl-rand-base64-32>

# Anti-Abuse: Cloudflare Turnstile (optional, disabled when empty)
# Get keys at https://dash.cloudflare.com → Turnstile
# Test keys (always pass): site=1x00000000000000000000AA secret=1x0000000000000000000000000000000AA
# TURNSTILE_SITE_KEY=
# TURNSTILE_SECRET_KEY=

# GIF Search (optional — Giphy API, free tier at https://developers.giphy.com)
# GIPHY_API_KEY=

# Data Retention (0 = keep forever)
AUDIT_LOG_RETENTION_DAYS=90
RESOLVED_REPORT_RETENTION_DAYS=180
EXPIRED_INVITE_CLEANUP=true